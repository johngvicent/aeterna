---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 1. Generar las rutas para cada artículo
export async function getStaticPaths() {
  const entradasGaleria = await getCollection('galeria');
  return entradasGaleria.map((entrada: CollectionEntry<'galeria'>) => ({
    params: { slug: entrada.slug }, props: { entrada },
  }));
}

// 2. Obtener los datos de la entrada
const { entrada } = Astro.props as { entrada: CollectionEntry<'galeria'> };
const { Content } = await entrada.render();
---

<Layout title={`${entrada.data.title} | AETERNA`}>
  <article class="art-article">
    
    <header class="art-header">
      <div class="meta">
        <span class="epoca-tag">{entrada.data.epoca}</span>
        {entrada.data.date && <time>{entrada.data.date.toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</time>}
      </div>
      <h1>{entrada.data.title}</h1>
      <p class="lead-text">{entrada.data.description}</p>
    </header>

    <div class="art-hero-image">
      <img src={entrada.data.image} alt={entrada.data.title} />
    </div>

    <section class="art-content">
      <div class="prose">
        <Content />
      </div>
    </section>

    <footer class="art-footer">
      <hr />
      <a href="javascript:history.back()" class="back-link">← Volver a la colección</a>
    </footer>

  </article>
</Layout>

<style>
  /* Estilos específicos para la página del artículo */
  .art-article {
    max-width: 1200px;
    margin: 0 auto;
    padding: 4rem 5%;
  }

  .art-header {
    text-align: center;
    margin-bottom: 4rem;
  }

  .meta {
    display: flex;
    justify-content: center;
    gap: 1rem;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #888;
    margin-bottom: 1.5rem;
  }

  .epoca-tag {
    color: #b59410; /* Dorado chic */
    font-weight: bold;
  }

  h1 {
    font-family: 'Playfair Display', serif;
    font-size: 3.5rem;
    line-height: 1.1;
    margin-bottom: 2rem;
  }

  .lead-text {
    font-size: 1.2rem;
    color: #555;
    max-width: 700px;
    margin: 0 auto;
    font-style: italic;
  }

  .art-hero-image {
    width: 100%;
    height: 70vh;
    margin-bottom: 5rem;
    overflow: hidden;
  }

  .art-hero-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Estilo para el cuerpo del texto (Markdown) */
  .art-content {
    max-width: 700px;
    margin: 0 auto;
  }

  .prose {
    font-family: 'Inter', sans-serif;
    font-size: 1.15rem;
    line-height: 1.8;
    color: #333;
  }

  /* Estilizar elementos del Markdown */
  .prose :global(h2) {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    margin-top: 3rem;
    margin-bottom: 1.5rem;
  }

  .prose :global(p) {
    margin-bottom: 1.5rem;
  }

  .art-footer {
    max-width: 700px;
    margin: 5rem auto 0;
    text-align: center;
  }

  hr {
    border: 0;
    border-top: 1px solid #eee;
    margin-bottom: 2rem;
  }

  .back-link {
    text-decoration: none;
    color: #1a1a1a;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: color 0.3s;
  }

  .back-link:hover {
    color: #b59410;
  }

  /* Responsivo */
  @media (max-width: 768px) {
    h1 { font-size: 2.2rem; }
    .art-hero-image { height: 40vh; }
  }
</style>